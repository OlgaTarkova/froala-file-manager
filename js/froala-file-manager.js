/*!
 * This file contains N1ED component.
 * Developer: N1ED/EdSDK
 * Website: https://n1ed.com/
 * License: Private N1ED license
 */
!function(e){var n={};function t(r){if(n[r])return n[r].exports;var l=n[r]={i:r,l:!1,exports:{}};return e[r].call(l.exports,l,l.exports,t),l.l=!0,l.exports}t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var l in e)t.d(r,l,function(n){return e[n]}.bind(null,l));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="/",t(t.s=0)}([function(e,n){var t=this&&this.__awaiter||function(e,n,t,r){return new(t||(t=Promise))(function(l,o){function i(e){try{s(r.next(e))}catch(e){o(e)}}function a(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){var n;e.done?l(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(i,a)}s((r=r.apply(e,n||[])).next())})},r=this&&this.__generator||function(e,n){var t,r,l,o,i={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,r&&(l=2&o[0]?r.return:o[0]?r.throw||((l=r.return)&&l.call(r),0):r.next)&&!(l=l.call(r,o[1])).done)return l;switch(r=0,l&&(o=[2&o[0],l.value]),o[0]){case 0:case 1:l=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(l=(l=i.trys).length>0&&l[l.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!l||o[1]>l[0]&&o[1]<l[3])){i.label=o[1];break}if(6===o[0]&&i.label<l[1]){i.label=l[1],l=o;break}if(l&&i.label<l[2]){i.label=l[2],i.ops.push(o);break}l[2]&&i.ops.pop(),i.trys.pop();continue}o=n.call(e,i)}catch(e){o=[6,e],r=0}finally{t=l=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};!function(e){if(!e.PLUGINS.image)throw new Error("Flmngr plugin requires image plugin to be enabled in Froala.");if(e.PLUGINS.Flmngr)throw new Error("Flmngr plugin was already registered.");var n="image",l="link",o="auto";e.RegisterCommand("FlmngrImage",{title:"",undo:!1,focus:!1,modal:!0,callback:function(){this.Flmngr.browse(n)},plugin:"Flmngr"}),e.RegisterCommand("FlmngrLink",{title:"",undo:!1,focus:!1,modal:!0,callback:function(){this.Flmngr.browse(l)},plugin:"Flmngr"}),e.RegisterCommand("FlmngrFile",{title:"",undo:!1,focus:!1,modal:!0,callback:function(){this.Flmngr.browse(o)},plugin:"Flmngr"}),e.DefineIcon("FlmngrImage",{NAME:"folder",PATH:"M20,6h-7l-2-2H4C2.9,4,2,4.9,2,6v12c0,1.1,0.9,2,2,2h16c1.1,0,2-0.9,2-2V8C22,6.9,21.1,6,20,6z M20,18H4V6h6.2l2,2H20V18z"}),e.DefineIcon("FlmngrLink",{NAME:"folder",PATH:"M20,6h-7l-2-2H4C2.9,4,2,4.9,2,6v12c0,1.1,0.9,2,2,2h16c1.1,0,2-0.9,2-2V8C22,6.9,21.1,6,20,6z M20,18H4V6h6.2l2,2H20V18z"}),e.DefineIcon("FlmngrFile",{NAME:"folder",PATH:"M20,6h-7l-2-2H4C2.9,4,2,4.9,2,6v12c0,1.1,0.9,2,2,2h16c1.1,0,2-0.9,2-2V8C22,6.9,21.1,6,20,6z M20,18H4V6h6.2l2,2H20V18z"}),e.DEFAULTS.imageInsertButtons.push("FlmngrImage");var i=e.DEFAULTS.imageInsertButtons.indexOf("imageManager");i>-1&&e.DEFAULTS.imageInsertButtons.splice(i,1),e.DEFAULTS.linkInsertButtons.push("FlmngrLink"),e.DEFAULTS.filesInsertButtons.push("FlmngrFile"),e.PLUGINS.ImgPen||e.PLUGINS.imageTUI||(e.PLUGINS.imageTUI=function(e){return{_init:function(){},launch:function(){window.closeFlmngrAlertImgPen=function(){e.modals.hide("flmngr.alertImgPen")},e.modals.create("flmngr.alertImgPen","<div style='font-size: 20px;line-height: 60px'>Image Editor</div>","<div style='text-align: left;padding:20px'><p>Please enable ImgPen plugin in order to use image editor with Flmngr file manager</p></div>"),e.modals.show("flmngr.alertImgPen")}}}),e.PLUGINS.Flmngr=function(i){return{_init:function(){var e,n,l=i.opts.Flmngr&&"string"==typeof i.opts.Flmngr.apiKey?i.opts.Flmngr.apiKey:"FROADFLT";window.onFlmngrLoaded=function(){i.isFlmngrLoaded=!0},function(e,n,t){n||(n=document);for(var r=n.getElementsByTagName("script"),l=!1,o=0;o<r.length;o++){var i=r[o].getAttribute("src");i&&-1!==i.indexOf(e)&&(l=!0,r[o])}if(l)return null;var a=n.createElement("script");a.type="text/javascript",null!=t&&(a.readyState?a.onreadystatechange=function(){"loaded"!==a.readyState&&"compvare"!==a.readyState||(a.onreadystatechange=null)}:a.onload=function(){}),a.src=e,n.getElementsByTagName("head")[0].appendChild(a)}("https://cloud.n1ed.com/cdn/"+l+"/n1flmngr.js",document,function(){}),i.Flmngr.checkConf()&&!1!==i.opts.Flmngr.actAsUploader&&function(){var e=this;i.opts.events||(i.opts.events={}),i.opts.events["image.inserted"]=function(n){return t(e,void 0,void 0,function(){var e,t,l,o,a;return r(this,function(r){switch(r.label){case 0:e=0,t=n,r.label=1;case 1:return e<t.length?(l=t[e]).src&&l.src.startsWith("blob:")?(o=l.src,[4,fetch(o).then(function(e){return e.blob()})]):[3,3]:[3,4];case 2:a=r.sent(),i.image.edit(i.$(l)),i.image.upload([a]),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})},i.opts.events["image.uploaded"]=function(e){function n(e,n){console.log(n),i.Flmngr.showUploadError(e)}try{var t=JSON.parse(e);if("ok"in t&&0==t.ok)i.Flmngr.waitForFeatureInit(function(){n(i.Flmngr.getFlmngrInstance().getErrorText(t.error),t)});else if("file"in t){var r=i.opts.Flmngr.urlFiles;r.endsWith("/")||(r+="/");var l=(t.file.dir+"/"+t.file.name).replace(/\/\//g,"/");l.startsWith("/")&&(l=l.substr(1)),l=r+l,i.image.insert(l,!1,null,i.image.get(),{link:l})}else n("Server returned incorrect response",t)}catch(e){console.log(e)}return!1},i.opts.imageUploadURL=i.opts.Flmngr.urlFileManager,i.opts.imageUploadParam="file",i.opts.imageUploadParams={action:"upload",dir:i.opts.defaultUploadDir||"/"},i.opts.events["file.inserted"]=function(n){return t(e,void 0,void 0,function(){var e,t,l,o,a;return r(this,function(r){switch(r.label){case 0:e=0,t=n,r.label=1;case 1:return e<t.length?(l=t[e]).href&&l.href.startsWith("blob:")?(o=l.href,[4,fetch(o).then(function(e){return e.blob()})]):[3,3]:[3,4];case 2:a=r.sent(),i.image.edit(i.$(l)),i.image.upload([a]),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})},i.opts.events["file.uploaded"]=function(e){function n(e,n){console.log(n),i.Flmngr.showUploadError(e),i.events.trigger("file.replaced")}console.log("file.uploaded");try{var t=JSON.parse(e);if("error"in t)i.Flmngr.waitFlmngr(function(){n(i.Flmngr.getFlmngrInstance().getErrorText(t.error),t)});else if("data"in t&&"string"==typeof t.data){var r=i.opts.Flmngr.urlFiles;r.endsWith("/")||(r+="/");var l=t.data;l.startsWith("/")&&(l=l.substr(1));var o=(l=r+l).lastIndexOf("/"),a=-1===o?l:l.substr(o+1);i.file.insert(l,a,null)}else n("Server returned incorrect response",t)}catch(e){console.log(e)}return!1},i.opts.fileUploadURL=i.opts.imageUploadURL,i.opts.fileUploadParam=i.opts.imageUploadParam,i.opts.fileUploadParams=i.opts.imageUploadParams}(),e="[data-cmd='FlmngrImage'],[data-cmd='FlmngrLink'],[data-cmd='FlmngrFile']",(n=document.createElement("style")).textContent=e.replace(/\]/g,"]:hover > div")+"{ background-color: #c4e3ff !important; }",document.getElementsByTagName("body")[0].appendChild(n),new MutationObserver(function(n){for(var t=0;t<n.length;t++){var r=n[t];if(r.addedNodes)for(var l=0;l<r.addedNodes.length;l++){var o=r.addedNodes.item(l);if(o.nodeType===Node.ELEMENT_NODE&&o.classList.contains("fr-popup")){var i=o.querySelector(e);if(i&&!i.hasAttribute("data-styled")){i.setAttribute("data-styled","true");var a=document.createElement("div");a.textContent="Browse",a.setAttribute("style","position: absolute;left: 0;top: 0;display: flex;justify-content: flex-start;align-items: center;height: 40px;padding-left: 40px;padding-right: 10px;background-color: #dbedfd;z-index: 0;"),i.appendChild(a),i.querySelector("svg").setAttribute("style","position: absolute;z-index: 1;left: 0;top: 0;"),i.parentElement.setAttribute("style","max-height:40px")}}}}}).observe(document.getElementsByTagName("body")[0],{childList:!0,subtree:!0})},checkConf:function(){return!(!i.opts.Flmngr||!i.opts.Flmngr.urlFileManager||"string"!=typeof i.opts.Flmngr.urlFileManager||0===i.opts.Flmngr.urlFileManager.trim().length||!i.opts.Flmngr.urlFiles||"string"!=typeof i.opts.Flmngr.urlFiles||0===i.opts.Flmngr.urlFiles.trim().length)},checkConfWithAlert:function(){return!!i.Flmngr.checkConf()||(window.closeFlmngrAlert=function(){i.modals.hide("flmngr.alert")},i.modals.create("flmngr.alert","<h4>Configure Flmngr file manager<h4>","<div style='text-align: left;padding:20px'><p>Please pass minimum required parameters to Froala to use Flmngr file manager:</p><code><pre>flmngr: {\n  urlFileManager: 'url-of-flmngr-script-on-server',\n  urlFiles: 'url-of-files-dir-on-server'\n}</pre></code><div style='text-align:right'><button class='fr-command' onclick='window.closeFlmngrAlert()'>Cancel</button><button class='fr-trim-button' style='margin-left:20px' onclick='window.open(\"https://froala-file-manager.com/#conf\", \"_blank\");window.closeFlmngrAlert()'>More info</button></div></div>"),i.modals.show("flmngr.alert"),!1)},showUploadError:function(e){i.modals.create("flmngr.errorUpload","<h4>Unable to upload the file</h4>","<div style='text-align: left;padding:20px'><p>Please check your server side configuration of Flmngr and server side logs of your HTTP webserver.</p><p>Error received:<br><span style='font-weight: bold'>"+e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")+"</span></p></div>"),i.modals.show("flmngr.errorUpload")},getFlmngrInstance:function(){return window.flmngr.create(i.opts.Flmngr||{})},uploadFile:function(e,n){i.Flmngr.checkConfWithAlert()&&i.Flmngr.getFlmngrInstance().upload({filesOrLinks:[e],onFinish:function(e){n(e[0])},onFail:function(e){i.Flmngr.showUploadError(e),n(null)},onCancel:function(){}})},browse:function(t){!function n(t){!0!==i.isFlmngrLoaded||e.PLUGINS.ImgPen&&!0!==i.isImgPenLoaded?setTimeout(function(){n(t)},50):t()}(function(){!function(){if(i.Flmngr.checkConfWithAlert()){var r=i.image.get(),a=null,s=null;r&&r.length>0&&(a=r[0])&&a.hasAttribute("src")&&(s=a.getAttribute("src"));var c=void 0;if(e.PLUGINS.ImgPen){var u="ImgPen"in i.opts?i.opts.ImgPen:{};u.integration="froala",c=window.imgpen.create(u)}var g=t===n,d=["jpg","jpeg","gip","png","webp","tiff","bmp"];i.Flmngr.getFlmngrInstance().browse({acceptExtensions:g?d:null,isMultiple:!a,selectedFiles:s?[s]:[],imgPen:c,onCancel:function(){},onFinish:function(e){for(var r=0;r<e.length;r++){var s=e[r],c=t;if(g&&(c=n),c===o){var u=s.lastIndexOf(".");if(u>-1){var f=s.substr(u+1);c=d.indexOf(f.toLowerCase())>-1?n:l}else c=l}c===n?i.image.insert(s,!1,void 0,a?i.$(a):void 0):c===l&&i.link.insert(s,s,{})}}})}}()})}}}}(window.FroalaEditor)}]);